<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="ToDo list" href="todolist.html" /><link rel="prev" title="Requirements" href="requirements.html" />

    <meta name="generator" content="sphinx-4.5.0, furo 2022.09.29"/>
        <title>Useful functions - ZooxantelaPy 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">ZooxantelaPy 0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">ZooxantelaPy 0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whatis.html">What is ZooxantelaPy ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="fetching.html">Fetching OBS data</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Requirements</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Useful functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="todolist.html">ToDo list</a></li>
<li class="toctree-l1"><a class="reference internal" href="inspiration.html">Inspiration</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="useful-functions">
<h1>Useful functions<a class="headerlink" href="#useful-functions" title="Permalink to this headline">#</a></h1>
<section id="quality-control">
<h2>Quality Control<a class="headerlink" href="#quality-control" title="Permalink to this headline">#</a></h2>
<section id="completeness">
<h3>Completeness<a class="headerlink" href="#completeness" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="assessment_py.data_availability.plot_date_file">
<span class="sig-prename descclassname"><span class="pre">assessment_py.data_availability.</span></span><span class="sig-name descname"><span class="pre">plot_date_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FIG_FOLDER_OUTPUT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#assessment_py.data_availability.plot_date_file" title="Permalink to this definition">#</a></dt>
<dd><p>Given a MSEED folder, this function returns a plot with the data completeness according to the header of each file.
Default plot includes an colorplot of a 2-D array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>FIG_FOLDER_OUTPUT</strong> (<em>str</em>) – Output file path to directly save the resulting image (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;/tmp/figures/&quot;</span></code>).</p></li>
<li><p><strong>directory_data</strong> (<em>str</em>) – Station folder path (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;~/NETWORK/*STATION*/CHANNEL.D/&quot;</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Figure with the plot.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Output[PDF]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="analysis-of-seismic-noise-levels">
<h3>Analysis of Seismic Noise Levels<a class="headerlink" href="#analysis-of-seismic-noise-levels" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="assessment_py.power_spectral_densities.calc_PSD">
<span class="sig-prename descclassname"><span class="pre">assessment_py.power_spectral_densities.</span></span><span class="sig-name descname"><span class="pre">calc_PSD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">XML_FILE</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">XML_FILE</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#assessment_py.power_spectral_densities.calc_PSD" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the probabilistic power spectral densities for one trace (specific station/channel).
Useful for site quality control checks.</p>
<p>Returns a .npz file format (A simple format for saving numpy arrays to disk with the full information about them).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – file path to trace [MSEED file] (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;~/STATION/CHANNEL.D/[MSEED</span> <span class="pre">FILE]&quot;</span></code>).</p></li>
<li><p><strong>XML_FILE</strong> (<em>str</em>) – file path to STATIONXML file (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;~/STATIONXML/***.XML&quot;</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>binary zipped archive</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>binary file[npz]</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Calculations are based on https://docs.obspy.org/packages/autogen/obspy.signal.spectral_estimation.PPSD.html.
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>See more in https://numpy.org/doc/stable/reference/generated/numpy.lib.format.html#module-numpy.lib.format.
</pre></div>
</div>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="assessment_py.power_spectral_densities.plot_PSD">
<span class="sig-prename descclassname"><span class="pre">assessment_py.power_spectral_densities.</span></span><span class="sig-name descname"><span class="pre">plot_PSD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">INITIAL_DATE</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">INITIAL_DATE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FINAL_DATE</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">FINAL_DATE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TIME_OF_WEEKDAY_DAY</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TIME_OF_WEEKDAY_DAY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TIME_OF_WEEKDAY_START_HOUR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TIME_OF_WEEKDAY_START_HOUR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TIME_OF_WEEKDAY_FINAL_HOUR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TIME_OF_WEEKDAY_FINAL_HOUR</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#assessment_py.power_spectral_densities.plot_PSD" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate 2D histogram stack with restrictions: starttime,endtime and time of day.</p>
<p>Also plot the probabilistic power spectral densities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>str</em>) – file path to .npz folder (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;~/STATION/CHANNEL.PPSD/*[npz</span> <span class="pre">FILES]&quot;</span></code>).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Figure with the plot.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Output[PDF]</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Calculations are based on https://docs.obspy.org/packages/autogen/obspy.signal.spectral_estimation.PPSD.calculate_histogram.html
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>For more information: McNamara, D. E. and Buland, R. P. (2004), Ambient Noise Levels in the Continental 
United States,Bulletin of the Seismological Society of America, 94(4), 1517-1527.
</pre></div>
</div>
</div>
</section>
</section>
<section id="noise-reduction">
<h2>Noise Reduction<a class="headerlink" href="#noise-reduction" title="Permalink to this headline">#</a></h2>
<section id="tilt-noise">
<h3>Tilt noise<a class="headerlink" href="#tilt-noise" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="Coherence_xy">
<span class="sig-name descname"><span class="pre">Coherence_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G_xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G_yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Coherence_xy" title="Permalink to this definition">#</a></dt>
<dd><p>Estimate Coherence and Coherence error.</p>
<p>Coherence describes the degree to which x(t) matches y(t) at the specified frequency.
it is the square of the correlation coefficient and represents the fraction of the power of y(t) that can be predicted linearly from x(t).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G_xy</strong> (<em>numpy.array</em>) – cross-spectral density function between x(t) and y(t).</p></li>
<li><p><strong>G_xx</strong> (<em>numpy.array</em>) – cross-spectral density function between x(t) and x(t).</p></li>
<li><p><strong>G_yy</strong> (<em>numpy.array</em>) – cross-spectral density function between y(t) and y(t).</p></li>
<li><p><strong>wind_number</strong> (<em>float</em>) – number of subrecords.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coherence,Coherence error</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of values</p>
</dd>
</dl>
</dd></dl>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>See more information in BELL, S.W.; FORSYTH, D.W.; RUAN, Y. Removing noise from the vertical component 
records of ocean-bottom seismometers: results from year one of the cascadia initiative, bulletin of the 
seismological society of america, 105, p. 300-313, 2014.
</pre></div>
</div>
</div>
<div class="admonition-formula admonition">
<p class="admonition-title">Formula</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ 
    \gamma^{2}_{xy}(f) = {|G_{xy}(f)|^{2} \over G_{xx}(f)G_{yy}(f)} (Coherence)
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \varepsilon (\gamma^{2}_{xy}(f)) = {\sqrt{2}(1 - \gamma^{2}_{xy}(f)) \over \sqrt{n_{d}}|\gamma_{xy}(f)|}  (Error)
\]</div>
</div>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="Admittance_xy">
<span class="sig-name descname"><span class="pre">Admittance_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G_xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G_yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Admittance_xy" title="Permalink to this definition">#</a></dt>
<dd><p>Estimate admittance and admittance error.</p>
<p>Admittance is the amplitude or gain factor of the transfer function between x(t) and y(t).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G_xy</strong> (<em>numpy.array</em>) – cross-spectral density function between x(t) and y(t).</p></li>
<li><p><strong>G_xx</strong> (<em>numpy.array</em>) – cross-spectral density function between x(t) and x(t).</p></li>
<li><p><strong>G_yy</strong> (<em>numpy.array</em>) – cross-spectral density function between y(t) and y(t).</p></li>
<li><p><strong>wind_number</strong> (<em>float</em>) – number of subrecords.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Admittance,Admittance error</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of values</p>
</dd>
</dl>
</dd></dl>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>See more information in BELL, S.W.; FORSYTH, D.W.; RUAN, Y. Removing noise from the vertical component 
records of ocean-bottom seismometers: results from year one of the cascadia initiative, bulletin of the 
seismological society of america, 105, p. 300-313, 2014.
</pre></div>
</div>
</div>
<div class="admonition-formula admonition">
<p class="admonition-title">Formula</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ 
    A_{xy}(f) = {|G_{xy}(f)| \over G_{xx}(f)} (Admittance)
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \varepsilon (A_{xy}(f)) = {\sqrt{1 - \gamma^{2}_{xy}(f)} \over \sqrt{2_{nd}}|\gamma_{xy}(f)|}  (Error)
\]</div>
</div>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="Phase_xy">
<span class="sig-name descname"><span class="pre">Phase_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G_xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G_yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Phase_xy" title="Permalink to this definition">#</a></dt>
<dd><p>The phase function gives the phase shift between x(t) and y(t) as a function of frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Q_xy</strong> (<em>numpy.array</em>) – cross-spectral density function between x(t) and y(t), after breaking X and Y into real and imaginary portions.</p></li>
<li><p><strong>C_xy</strong> (<em>numpy.array</em>) – cross-spectral density function between x(t) and y(t), after breaking X and Y into real and imaginary portions.</p></li>
<li><p><strong>G_xy</strong> (<em>numpy.array</em>) – cross-spectral density function between x(t) and y(t).</p></li>
<li><p><strong>G_xx</strong> (<em>numpy.array</em>) – cross-spectral density function between x(t) and x(t).</p></li>
<li><p><strong>G_yy</strong> (<em>numpy.array</em>) – cross-spectral density function between y(t) and y(t).</p></li>
<li><p><strong>wind_number</strong> (<em>float</em>) – number of subrecords.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coherence,Coherence error</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of values</p>
</dd>
</dl>
</dd></dl>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>See more information in BELL, S.W.; FORSYTH, D.W.;RUAN, Y. Removing noise from the vertical component 
records of ocean-bottom seismometers: results from year one of the cascadia initiative, bulletin 
of the seismological society of america, 105, p. 300-313, 2014.
</pre></div>
</div>
</div>
<div class="admonition-formula admonition">
<p class="admonition-title">Formula</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ 
    \phi_{xy}(f) = arctan \left [Q_{xy}(f) \over C_{xy}(f) \right ] (Phase)
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \varepsilon (phi_{xy}(f)) = {\sqrt{1 - \gamma^{2}_{xy}(f)} \over \sqrt{2_{nd}}|\gamma_{xy}(f)|}  (Error)
\]</div>
</div>
</div>
</section>
<section id="clock-drift">
<h3>Clock drift<a class="headerlink" href="#clock-drift" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="obscorr_window">
<span class="sig-name descname"><span class="pre">obscorr_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_data1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_data2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#obscorr_window" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the CrossCorrelation according to the distance between two stations.</p>
<dl class="simple">
<dt>The signal window is defined by <em>vmin</em> and <em>vmax</em>:</dt><dd><p>dist/<em>vmax</em> &lt; t &lt; dist/<em>vmin</em></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data1</strong> (<em>numpy array</em>) – amplitude data of the station 1.</p></li>
<li><p><strong>time_data1</strong> (<em>numpy array</em>) – time data of the station 1.</p></li>
<li><p><strong>data2</strong> (<em>numpy array</em>) – amplitude data of the station 2.</p></li>
<li><p><strong>time_data2</strong> (<em>numpy array</em>) – time data of the station 2.</p></li>
<li><p><strong>dist</strong> (<em>float</em>) – distance between the stations.</p></li>
<li><p><strong>vmin</strong> (<em>float</em>) – minimum velocity of Rayleigh waves.</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – maximum velocity of Rayleigh waves.</p></li>
<li><p><strong>sampling_rate</strong> (<em>float</em>) – sampling rate of the data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>shift/sampling_rate, correlation coefficient</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of values.</p>
</dd>
</dl>
</dd></dl>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>See more information in Sarah Hable, Karin Sigloch, Guilhem Barruol, Simon C Stähler, Céline Hadziioannou, 
Clock errors in land and ocean bottom seismograms: high-accuracy estimates from multiple-component noise 
cross-correlations, Geophysical Journal International, Volume 214, Issue 3, September 2018, Pages 2014–2034,
https://doi.org/10.1093/gji/ggy236
</pre></div>
</div>
</div>
<div class="admonition-formula admonition">
<p class="admonition-title">Formula</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>See more in https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.correlate.html
</pre></div>
</div>
</div>
</section>
<section id="sensor-orientation">
<h3>Sensor Orientation<a class="headerlink" href="#sensor-orientation" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="Calc_orientation">
<span class="sig-name descname"><span class="pre">Calc_orientation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HHE_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">HHN_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">HHZ_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Calc_orientation" title="Permalink to this definition">#</a></dt>
<dd><p>Estimate the optimal sensor orientations by ﬁnding the orientation azimuth that maximizes the correlation between the measured response functions C_rz and C_zz between station-event pairs. We then estimate the angle (ANG) needed to rotate the H1-H2 coordinate system into radial-transverse coordinate, using the guiding principle that the true ANG will maximizes the zero-lag cross-correlation between the radial response function C_rz and phase-shifted vertical response function C_zz (S_zr minimum). The optimization is performed via a grid search with 1 degree steps, using the R_zr value as quality control estimate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>HHE_data</strong> (<em>obspy.trace</em>) – horizontal component (E-W).</p></li>
<li><p><strong>HHN_data</strong> (<em>obspy.trace</em>) – horizontal component (N-S).</p></li>
<li><p><strong>HHZ_data</strong> (<em>obspy.trace</em>) – vertical component (U-D).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ANG,S_zr, Rzr,SNR</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of values ([0, 360], [−1, +1],[−1, +1],[-,+])</p>
</dd>
</dl>
</dd></dl>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>See more information in Xu, W., S. Yuan, W. Wang, X. Luo, and L. Li (2020). Comparing Orientation Analysis Methods for a Shallow-Water Ocean-Bottom Seismometer Array in the Bohai Sea, China, Bull. Seismol. Soc. Am. XX, 1–11, doi: 10.1785/0120200174.
</pre></div>
</div>
</div>
<div class="admonition-formula admonition">
<p class="admonition-title">Formula</p>
<p>To rotate <span class="math notranslate nohighlight">\(C_{ez}\)</span> and <span class="math notranslate nohighlight">\(C_{nz}\)</span> to the radial and transverse components <span class="math notranslate nohighlight">\(C_{rz}\)</span>,<span class="math notranslate nohighlight">\(C_{tz}\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split} 
    \left ( \frac{C_{rz}}{C_{tz}} \right ) = \begin{pmatrix}
    cos \theta &amp; sin \theta \\ 
    -sin \theta  &amp; cos \theta  
    \end{pmatrix}
    =
    \left ( \frac{C_{nz}}{C_{ez}} \right )
\end{split}\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    S_{rz}(\psi) = \frac{\rho(C_{rz},\tilde{C_{zz}})}{\rho(\tilde{C_{zz}},\tilde{C_{zz}})}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    R_{rz}(\psi) = \frac{\rho(C_{rz},\tilde{C_{zz}})}{\sqrt{\rho(C_{rz},C_{rz})\rho(\tilde{C_{zz}},\tilde{C_{zz}})}}\]</div>
</div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="todolist.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">ToDo list</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="requirements.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Requirements</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, dIOGO LOC
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Useful functions</a><ul>
<li><a class="reference internal" href="#quality-control">Quality Control</a><ul>
<li><a class="reference internal" href="#completeness">Completeness</a></li>
<li><a class="reference internal" href="#analysis-of-seismic-noise-levels">Analysis of Seismic Noise Levels</a></li>
</ul>
</li>
<li><a class="reference internal" href="#noise-reduction">Noise Reduction</a><ul>
<li><a class="reference internal" href="#tilt-noise">Tilt noise</a></li>
<li><a class="reference internal" href="#clock-drift">Clock drift</a></li>
<li><a class="reference internal" href="#sensor-orientation">Sensor Orientation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>